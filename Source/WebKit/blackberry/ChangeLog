2013-05-02  Genevieve Mak  <gmak@rim.com>

        [BlackBerry] Cannot touch scroll readonly text input.
        https://bugs.webkit.org/show_bug.cgi?id=115378

        Reviewed by Rob Buis.

        PR #332902
        Reviewed Internally by Mike Fenton.
        Forgot half the patch.
        Node::rendererIsEditable() returns false if the input element has the readonly tag set.
        Check the node type instead.

        * Api/InRegionScroller.cpp:
        (BlackBerry::WebKit::InRegionScrollerPrivate::canScrollRenderBox):

2013-05-02  Iris Wu  <shuwu@blackberry.com>

        [BlackBerry] Make scroll position adjustment work with pages with fixed position elements.
        https://bugs.webkit.org/show_bug.cgi?id=115178

        Reviewed by Rob Buis.

        PR 308796
        Debug build fix.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::fixedElementSizeDelta):

2013-05-01  Iris Wu  <shuwu@blackberry.com>

         [BlackBerry] Upstream smart selection
         https://bugs.webkit.org/show_bug.cgi?id=111226

        Reviewed by Rob Buis.

        Calling userInterfaceViewportAccessor()->documentViewportRect() on WK thread
        caused crash.
        But viewport from webkitThreadViewportAccessor uses unadjusted size which is
        wrong for email.
        The solution here is to get actual viewport size on UI thread and then pass it
        to WebKit::SelectionHandler.

        PR 333763
        Reviewed Internally By Jakob Petsovits.

        * Api/InRegionScroller.cpp:
        (BlackBerry::WebKit::InRegionScrollerPrivate::updateSelectionScrollView):
        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::setSelectionDocumentViewportSize):
        (WebKit):
        * Api/WebPage.h:
        * WebKitSupport/SelectionHandler.cpp:
        (BlackBerry::WebKit::SelectionHandler::selectAtPoint):
        (BlackBerry::WebKit::SelectionHandler::ensureSelectedTextVisible):
        (BlackBerry::WebKit::SelectionHandler::selectionViewportRect):
        * WebKitSupport/SelectionHandler.h:
        (BlackBerry::WebKit::SelectionHandler::setSelectionViewportSize):
        (BlackBerry::WebKit::SelectionHandler::setSelectionSubframeViewportRect):
        (SelectionHandler):

2013-04-30  Genevieve Mak  <gmak@rim.com>

        [BlackBerry] Cannot touch scroll readonly text input.
        https://bugs.webkit.org/show_bug.cgi?id=115378

        Reviewed by Rob Buis.

        PR #332902
        Reviewed Internally by Mike Fenton.
        Node::rendererIsEditable() returns false if the input element has the readonly tag set.
        Check the node type instead.

        * WebKitSupport/DOMSupport.cpp:
        (BlackBerry::WebKit::DOMSupport::isShadowHostTextInputElement):
        (DOMSupport):
        * WebKitSupport/DOMSupport.h:
        * WebKitSupport/InRegionScrollableArea.cpp:
        (BlackBerry::WebKit::InRegionScrollableArea::InRegionScrollableArea):

2013-04-29  Jakob Petsovits  <jpetsovits@blackberry.com>

        [BlackBerry] Replace disappearing fillBuffer() API with graphics context drawing
        https://bugs.webkit.org/show_bug.cgi?id=115360
        Internal PR 303048.

        Reviewed by Rob Buis.

        Instead of using fillBuffer() to draw directly to the
        target buffer, we now lock a Drawable on it and fill it
        with PlatformGraphicsContext::addPredefinedPattern().

        As a bonus, this also includes related clean-ups -
        simpler checkerboard painting code, removal of
        fillWindow(), clearWindow() and paintDefaultBackground(),
        as well as getting rid of the DEBUG_CHECKERBOARD define
        which has been useless for performance tracing purposes
        for a while now.

        * Api/BackingStore.cpp:
        (BlackBerry::WebKit::BackingStorePrivate::blitVisibleContents):
        * Api/BackingStore_p.h:

2013-04-26  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Check for valid element in elementTouched
        https://bugs.webkit.org/show_bug.cgi?id=115205

        Reviewed by Rob Buis.

        Internally reviewed by Genevieve Mak.

        PR 331546
        We might receive a null ptr from nodeAsElementIfApplicable which
        is passed in here. Check to make sure it's valid before using.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::elementTouched):

2013-04-26  Martin Robinson  <mrobinson@igalia.com>

        Remove the remaining Skia #ifdefs
        https://bugs.webkit.org/show_bug.cgi?id=114886

        Reviewed by Benjamin Poulain.

        * Api/WebPage.cpp: Remove Skia #ifdef references.
        * WebCoreSupport/AboutDataUseFeatures.in: Ditto.

2013-04-26  Mary Wu  <mary.wu@torchmobile.com.cn>

        [BlackBerry] Should check if it's cached resource before download
        https://bugs.webkit.org/show_bug.cgi?id=115101

        Reviewed by Rob Buis.

        Since main resource maybe cached, if user want to save the resource, we first check
        if it's cached. If yes, don't need to initiate a fresh load again, but get the
        cached resource data out to save.

        RIM bug# 324003, internally reviewed by Charles Wei.

        * WebCoreSupport/FrameLoaderClientBlackBerry.cpp:
        (WebCore::FrameLoaderClientBlackBerry::convertMainResourceLoadToDownload):

2013-04-26  Mary Wu  <mary.wu@torchmobile.com.cn>

        [BlackBerry] Clean up load interface in WebPage
        https://bugs.webkit.org/show_bug.cgi?id=113267

        Reviewed by Rob Buis.

        Remove unused loadExtended(), combine load() and download() api in WebPage.
        RIM Bug# 315535, internally reviewed by Joe Mason.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::load):
        * Api/WebPage.h:

2013-04-25  Andrew Lo  <anlo@rim.com>

        [BlackBerry] Selection overlay on non-composited iframes are incorrectly positioned.
        https://bugs.webkit.org/show_bug.cgi?id=115197

        Reviewed by Rob Buis.

        When drawing the selection overlay, the rects to
        paint when selecting text on non-composited sub-frames
        need to be adjusted by the frame position.

        * WebKitSupport/SelectionOverlay.cpp:
        (BlackBerry::WebKit::SelectionOverlay::paintContents):

2013-04-25  Andreas Kling  <akling@apple.com>

        Remove ENABLE(PARSED_STYLE_SHEET_CACHING) and make it always-on.

        Rubber-stamped by Anders Koivisto.

        * WebCoreSupport/AboutDataEnableFeatures.in:

2013-04-25  Iris Wu  <shuwu@blackberry.com>

        [BlackBerry] Make scroll position adjustment work with pages with fixed position elements.
        https://bugs.webkit.org/show_bug.cgi?id=115178

        Reviewed by Rob Buis.

        PR 308796

        Currently the position WebPage::adjustDocumentScrollPosition adjusts is the top
        left point of the viewport.
        On the page with fixed position elements, we want it to adjust the position beneath
        the fixed elements so it can be always visible.

        The basic idea is:
        1.  Detect if there are fixed position elements before going through ProximityDetector.
        2.  If the fixed element exists, calculate its the size and the actual visible position
            beneath it.
        3.  Pass the position to ProximityDetector. Then according to the new position we get,
            calculate the top left position of the viewport (final scroll position).

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::fixedElementSizeDelta):
        (WebKit):
        * Api/WebPage.h:
        * Api/WebPageCompositor.cpp:
        (BlackBerry::WebKit::WebPageCompositorPrivate::findFixedElementRect):
        (WebKit):
        * Api/WebPageCompositor_p.h:
        (WebPageCompositorPrivate):

2013-04-25  Mike Lattanzio  <mlattanzio@blackberry.com>

        [BlackBerry] Enable balanced page group load deferrer behaviour.
        https://bugs.webkit.org/show_bug.cgi?id=115189

        Reviewed by Rob Buis.

        Prevent a possible deadlock by enabling balanced deferrers.
        Internally reviewed by: Joe Mason
        PR 329986

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::init):

2013-04-25  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: ConsoleMessage should include line and column number where possible
        https://bugs.webkit.org/show_bug.cgi?id=114929

        Reviewed by Timothy Hatcher.

        * Api/DumpRenderTreeClient.h:
        * Api/WebPageClient.h:
        * WebCoreSupport/ChromeClientBlackBerry.cpp:
        (WebCore::ChromeClientBlackBerry::addMessageToConsole):
        * WebCoreSupport/ChromeClientBlackBerry.h:
        (ChromeClientBlackBerry):

2013-04-25  Konrad Piascik  <kpiascik@blackberry.com>

        [BlackBerry] Get rid of return in void method
        https://bugs.webkit.org/show_bug.cgi?id=115186

        Reviewed by Rob Buis.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::setForcedTextEncoding):

2013-04-24  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Do not clear focus on a node when tapping on form controls
        https://bugs.webkit.org/show_bug.cgi?id=115055

        Reviewed by Rob Buis.

        Internally reviewed by Genevieve Mak.

        PR316069
        To allow for rich text editors to apply styles on an input field
        or highlighted text, we must maintain focus on the current element
        when tapping on form elements. Moving the code that clears this
        context to trigger off TouchHold instead of TouchPress.

        * WebKitSupport/TouchEventHandler.cpp:
        (BlackBerry::WebKit::TouchEventHandler::doFatFingers):

== Rolled over to ChangeLog-2013-04-24 ==
