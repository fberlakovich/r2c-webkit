2015-12-06  David Kilzer  <ddkilzer@apple.com>

        REGRESSION(r193584): Causes heap use-after-free crashes in Web Inspector tests with AddressSanitizer (Requested by ddkilzer on #webkit).
        https://bugs.webkit.org/show_bug.cgi?id=151929

        Reverted changeset:

        "[ES6] "super" and "this" should be lexically bound inside an
        arrow function and should live in a JSLexicalEnvironment"
        https://bugs.webkit.org/show_bug.cgi?id=149338
        http://trac.webkit.org/changeset/193584

2015-12-06  Skachkov Oleksandr  <gskachkov@gmail.com>

        [ES6] "super" and "this" should be lexically bound inside an arrow function and should live in a JSLexicalEnvironment
        https://bugs.webkit.org/show_bug.cgi?id=149338

        Reviewed by Saam Barati.

        * js/arrowfunction-supercall-expected.txt: Added.
        * js/arrowfunction-supercall.html: Added.
        * js/arrowfunction-tdz-expected.txt: Added new expectation.
        * js/script-tests/arrowfunction-supercall.js: Added.
        * js/script-tests/arrowfunction-tdz.js: Added new cases.

2015-12-05  David Kilzer  <ddkilzer@apple.com>

        REGRESSION (r193487): Modern IDB: storage/indexeddb/index-multientry.html crashes

        * platform/mac-wk1/TestExpectations: Skip test that crashes
        on every run: storage/indexeddb/index-multientry.html.

2015-12-04  Zalan Bujtas  <zalan@apple.com>

        Garbage in page tiles when document is too long.
        https://bugs.webkit.org/show_bug.cgi?id=151906
        rdar://problem/23695858

        Reviewed by Simon Fraser.

        * platform/ios-simulator/fast/block/float/overhanging-tall-block-expected.txt:
        * platform/mac-mavericks/fast/block/float/overhanging-tall-block-expected.txt:
        * platform/mac/fast/block/float/overhanging-tall-block-expected.txt:

2015-12-04  Brady Eidson  <beidson@apple.com>

        Modern IDB: Add some more custom exception messages, passing some more tests.
        https://bugs.webkit.org/show_bug.cgi?id=151898

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/keypath-arrays-expected.txt:
        * storage/indexeddb/noblobs-expected.txt:
        * storage/indexeddb/object-lookups-in-versionchange-expected.txt:
        * storage/indexeddb/request-result-cache-expected.txt:
        * storage/indexeddb/transaction-after-close-expected.txt:
        * storage/indexeddb/transaction-and-objectstore-calls-expected.txt:
        * storage/indexeddb/transaction-read-only-expected.txt:

2015-12-04  Brady Eidson  <beidson@apple.com>

        Modern IDB: Add some more custom exception messages, passing some more tests.
        https://bugs.webkit.org/show_bug.cgi?id=151895

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/aborted-versionchange-closes-expected.txt:
        * storage/indexeddb/cursor-continue-dir-expected.txt:
        * storage/indexeddb/cursor-continue-expected.txt:
        * storage/indexeddb/deleteIndex-expected.txt:
        * storage/indexeddb/modern/idbdatabase-transaction-failures-expected.txt:

2015-12-04  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Implement Number.prototype.toLocaleString in ECMA-402
        https://bugs.webkit.org/show_bug.cgi?id=147610

        Reviewed by Benjamin Poulain.

        Add tests for ECMA-402 Number.prototype.toLocaleString.
        Since NumberFormat is not fully implemented, don't test locale-specific behavior yet.

        * js/number-toLocaleString-expected.txt: Added.
        * js/number-toLocaleString.html: Added.
        * js/script-tests/number-toLocaleString.js: Added.

2015-12-04  Brady Eidson  <beidson@apple.com>

        Modern IDB: Flip test expectations around so we only list failures.
        https://bugs.webkit.org/show_bug.cgi?id=151880

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:

2015-12-04  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/cursor-update.html fails.
        https://bugs.webkit.org/show_bug.cgi?id=151879

        Reviewed by Oliver Hunt.

        * platform/mac-wk1/TestExpectations:

2015-12-04  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/version-change-exclusive.html fails
        https://bugs.webkit.org/show_bug.cgi?id=151870

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/modern/double-open-expected.txt: Added.
        * storage/indexeddb/modern/double-open.html: Added.
        * storage/indexeddb/version-change-exclusive-expected.txt:

2015-12-04  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/exceptions.html fails.
        https://bugs.webkit.org/show_bug.cgi?id=151732

        Reviewed by Alex Christensen.

        Lots of new wk2-specific expectations to keep Legacy IDB passing for now.
        
        * platform/mac-wk1/TestExpectations:
        * platform/wk2/imported/w3c/indexeddb/idbcursor_continue_index5-expected.txt: Added.
        * platform/wk2/imported/w3c/indexeddb/idbcursor_continue_index6-expected.txt: Added.
        * platform/wk2/imported/w3c/indexeddb/idbcursor_continue_invalid-expected.txt: Added.
        * platform/wk2/imported/w3c/indexeddb/idbindex_get7-expected.txt: Added.
        * platform/wk2/imported/w3c/indexeddb/idbindex_getKey7-expected.txt: Added.
        * platform/wk2/imported/w3c/indexeddb/idbindex_openCursor2-expected.txt: Added.
        * platform/wk2/imported/w3c/indexeddb/idbindex_openKeyCursor3-expected.txt: Added.
        * platform/wk2/imported/w3c/indexeddb/keypath-expected.txt: Added.
        * platform/wk2/storage/indexeddb/aborted-versionchange-closes-expected.txt: Copied from LayoutTests/storage/indexeddb/aborted-versionchange-closes-expected.txt.
        * platform/wk2/storage/indexeddb/bad-keypath-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/bad-keypath-expected.txt.
        * platform/wk2/storage/indexeddb/basics-expected.txt: Copied from LayoutTests/storage/indexeddb/basics-expected.txt.
        * platform/wk2/storage/indexeddb/clear-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/clear-expected.txt.
        * platform/wk2/storage/indexeddb/create-and-remove-object-store-expected.txt: Copied from LayoutTests/storage/indexeddb/create-and-remove-object-store-expected.txt.
        * platform/wk2/storage/indexeddb/create-objectstore-basics-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/create-objectstore-basics-expected.txt.
        * platform/wk2/storage/indexeddb/cursor-continue-dir-expected.txt: Added.
        * platform/wk2/storage/indexeddb/cursor-continue-expected.txt: Added.
        * platform/wk2/storage/indexeddb/cursor-finished-expected.txt: Copied from LayoutTests/storage/indexeddb/cursor-finished-expected.txt.
        * platform/wk2/storage/indexeddb/cursors-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/cursors-expected.txt.
        * platform/wk2/storage/indexeddb/database-basics-expected.txt: Added.
        * platform/wk2/storage/indexeddb/deleteIndex-bug110792-expected.txt: Added.
        * platform/wk2/storage/indexeddb/index-count-expected.txt: Added.
        * platform/wk2/storage/indexeddb/intversion-close-in-oncomplete-expected.txt: Added.
        * platform/wk2/storage/indexeddb/intversion-close-in-upgradeneeded-expected.txt: Added.
        * platform/wk2/storage/indexeddb/invalid-keys-expected.txt: Added.
        * platform/wk2/storage/indexeddb/key-requirements-delete-null-key-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/key-requirements-delete-null-key-expected.txt.
        * platform/wk2/storage/indexeddb/key-requirements-inline-and-passed-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/key-requirements-inline-and-passed-expected.txt.
        * platform/wk2/storage/indexeddb/key-requirements-put-no-key-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/key-requirements-put-no-key-expected.txt.
        * platform/wk2/storage/indexeddb/key-requirements-put-null-key-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/key-requirements-put-null-key-expected.txt.
        * platform/wk2/storage/indexeddb/key-type-array-expected.txt: Added.
        * platform/wk2/storage/indexeddb/keypath-arrays-expected.txt: Added.
        * platform/wk2/storage/indexeddb/keypath-edges-expected.txt: Added.
        * platform/wk2/storage/indexeddb/keyrange-expected.txt: Added.
        * platform/wk2/storage/indexeddb/mozilla/clear-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/clear-expected.txt.
        * platform/wk2/storage/indexeddb/mozilla/create-objectstore-basics-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/create-objectstore-basics-expected.txt.
        * platform/wk2/storage/indexeddb/mozilla/cursors-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/cursors-expected.txt.
        * platform/wk2/storage/indexeddb/mozilla/key-requirements-delete-null-key-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/key-requirements-delete-null-key-expected.txt.
        * platform/wk2/storage/indexeddb/mozilla/readonly-transactions-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/readonly-transactions-expected.txt.
        * platform/wk2/storage/indexeddb/object-lookups-in-versionchange-expected.txt: Added.
        * platform/wk2/storage/indexeddb/objectstore-count-expected.txt: Added.
        * platform/wk2/storage/indexeddb/open-cursor-expected.txt: Added.
        * platform/wk2/storage/indexeddb/readonly-transactions-expected.txt: Copied from LayoutTests/storage/indexeddb/mozilla/readonly-transactions-expected.txt.
        * platform/wk2/storage/indexeddb/removed-expected.txt: Added.
        * platform/wk2/storage/indexeddb/request-result-cache-expected.txt: Added.
        * platform/wk2/storage/indexeddb/transaction-abort-expected.txt: Copied from LayoutTests/storage/indexeddb/transaction-abort-expected.txt.
        * platform/wk2/storage/indexeddb/transaction-active-flag-expected.txt: Added.
        * platform/wk2/storage/indexeddb/transaction-after-close-expected.txt: Added.
        * platform/wk2/storage/indexeddb/transaction-read-only-expected.txt: Added.
        * platform/wk2/storage/indexeddb/version-change-exclusive-expected.txt: Added.
        * storage/indexeddb/aborted-versionchange-closes-expected.txt:
        * storage/indexeddb/basics-expected.txt:
        * storage/indexeddb/create-and-remove-object-store-expected.txt:
        * storage/indexeddb/cursor-finished-expected.txt:
        * storage/indexeddb/exceptions-expected.txt:
        * storage/indexeddb/modern/createobjectstore-failures-expected.txt:
        * storage/indexeddb/modern/double-abort-expected.txt:
        * storage/indexeddb/modern/idbdatabase-deleteobjectstore-failures-expected.txt:
        * storage/indexeddb/modern/idbdatabase-transaction-failures-expected.txt:
        * storage/indexeddb/mozilla/bad-keypath-expected.txt:
        * storage/indexeddb/mozilla/clear-expected.txt:
        * storage/indexeddb/mozilla/create-objectstore-basics-expected.txt:
        * storage/indexeddb/mozilla/cursors-expected.txt:
        * storage/indexeddb/mozilla/key-requirements-delete-null-key-expected.txt:
        * storage/indexeddb/mozilla/key-requirements-inline-and-passed-expected.txt:
        * storage/indexeddb/mozilla/key-requirements-put-no-key-expected.txt:
        * storage/indexeddb/mozilla/key-requirements-put-null-key-expected.txt:
        * storage/indexeddb/mozilla/readonly-transactions-expected.txt:
        * storage/indexeddb/resources/exceptions.js:
        (testObjectStore):
        * storage/indexeddb/transaction-abort-expected.txt:

2015-12-04  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Unskip many inspector/debugger tests
        https://bugs.webkit.org/show_bug.cgi?id=151843

        Reviewed by Timothy Hatcher.

        * TestExpectations:
        * platform/mac/TestExpectations:
        Skip specific tests.

        * platform/mac-wk2/TestExpectations:
        Test no longer existed.

        * inspector/debugger/resources/exception.js:
        (exceptionDOM):
        Keep the code outputing a NotFoundException. This particular
        invocation was recently changed to throw a TypeError.

2015-12-04  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Remove untested and unused Worker inspection
        https://bugs.webkit.org/show_bug.cgi?id=151848

        Reviewed by Brian Burg.

        * inspector/debugger/pause-dedicated-worker-expected.txt: Removed.
        * inspector/debugger/pause-dedicated-worker.html: Removed.
        * inspector/debugger/resources/dedicated-worker.js: Removed.
        * inspector/debugger/terminate-dedicated-worker-while-paused-expected.txt: Removed.
        * inspector/debugger/terminate-dedicated-worker-while-paused.html: Removed.

2015-12-04  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Specifically Identify the Global Lexical Environment Scope
        https://bugs.webkit.org/show_bug.cgi?id=151828

        Reviewed by Brian Burg.

        * inspector/debugger/breakpoint-scope-expected.txt:
        * inspector/debugger/breakpoint-scope.html:
        * inspector/debugger/resources/scope.js:
        Update the test to include something in the global lexical
        environment and ensure it is identified as such.

2015-12-03  Sergio Villar Senin  <svillar@igalia.com>

        [css-grid] Fix height computation of grid items with borders inside fr tracks
        https://bugs.webkit.org/show_bug.cgi?id=151798

        Reviewed by Zalan Bujtas.

        * fast/css-grid-layout/grid-item-with-border-in-fr-expected.txt: Added.
        * fast/css-grid-layout/grid-item-with-border-in-fr.html: Added.

2015-12-03  Brady Eidson  <beidson@apple.com>

        Modern IDB: Fix up tests that refer to non-standard IDBVersionChangeEvent.dataLoss.
        https://bugs.webkit.org/show_bug.cgi?id=151850

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:
        
        * storage/indexeddb/data-corruption-expected.txt: Removed.
        * storage/indexeddb/data-corruption.html: Removed.
        * storage/indexeddb/resources/data-corruption.js: Removed.

        * storage/indexeddb/events-expected.txt:
        * storage/indexeddb/resources/events.js:

2015-12-03  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/cursor-index-delete.html fails.
        https://bugs.webkit.org/show_bug.cgi?id=151847

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:

2015-12-03  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] Update MediaStreamTrack.getCapabilities
        https://bugs.webkit.org/show_bug.cgi?id=151728

        Reviewed by Jer Noble.

        * fast/mediastream/MediaStreamTrack-getCapabilities-expected.txt: Added.
        * fast/mediastream/MediaStreamTrack-getCapabilities.html: Added.
        * fast/mediastream/MediaStreamTrack-getSettings-expected.txt:
        * fast/mediastream/MediaStreamTrack-getSettings.html:

2015-12-03  Ryan Haddad  <ryanhaddad@apple.com>

        Removing deleted test storage/indexeddb/objectstore-keycursor.html from TestExpectations file
        https://bugs.webkit.org/show_bug.cgi?id=151772

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2015-12-03  Keith Rollin  <krollin@apple.com>

        [Win] fast/forms/HTMLOptionElement_label03.html failing on win7
        https://bugs.webkit.org/show_bug.cgi?id=150909
        rdar://problem/23539673

        Reviewed by Darin Adler.

        Mark fast/forms/HTMLOptionElement_label03.html as being expected to
        pass. Also update some text in HTMLOptionElement_label02.html and
        HTMLOptionElement_label03.html so that it no longer refers to our
        trying to match IE (which we are no longer doing).

        * fast/forms/HTMLOptionElement_label02.html:
        * fast/forms/HTMLOptionElement_label03.html:
        * platform/win/TestExpectations:

2015-12-03  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/cursor-advance.html fails.
        https://bugs.webkit.org/show_bug.cgi?id=151731

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/cursor-advance-expected.txt:

2015-12-03  Brent Fulgham  <bfulgham@apple.com>

        Allow JavaScript to iterate over plugins for local files
        https://bugs.webkit.org/show_bug.cgi?id=151783
        <rdar://problem/23692113>

        Modify the existing 'local file' plugin tests so that they don't turn on the debugging
        flag to allow iterating over all plugins. Then create a new HTTP test (based on the
        existing plugin-javascript-access test) to make sure that plugin iteration is blocked
        for non-local-file access.

        Reviewed by Alexey Proskuryakov.

        * http/tests/plugins/plugin-javascript-access-expected.txt: Added.
        * http/tests/plugins/plugin-javascript-access.html: Added.
        * plugins/plugin-javascript-access.html: Remove unneeded 'internals.setShowAllPlugins' call.
        * plugins/script-tests/navigator-mimeTypes-length.js: Ditto.

2015-12-03  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/cursor-skip-deleted.html fails.
        https://bugs.webkit.org/show_bug.cgi?id=151794

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:

2015-12-02  Sam Weinig  <sam@webkit.org>

        Promise callbacks should be called at microtask checkpoints
        https://bugs.webkit.org/show_bug.cgi?id=147933

        Reviewed by Chris Dumez.

        * fast/dom/microtask-promise-mutation-observer-order-expected.txt: Added.
        * fast/dom/microtask-promise-mutation-observer-order.html: Added.

2015-12-03  Daniel Bates  <dabates@apple.com>

        ASSERT_WITH_SECURITY_IMPLICATION in WebCore::DocumentOrderedMap::add()
        https://bugs.webkit.org/show_bug.cgi?id=126662
        <rdar://problem/15775508>

        Reviewed by Brent Fulgham.

        Add test to ensure that we do not assert when inserting a subtree that has an element with
        a duplicate id before removing the original subtree.

        * svg/custom/insert-subtree-with-duplicate-id-before-removing-subtree-expected.txt: Added.
        * svg/custom/insert-subtree-with-duplicate-id-before-removing-subtree.svg: Added.

2015-12-03  Javier Fernandez  <jfernandez@igalia.com>

        [css-grid] margin-left:auto and margin-top:auto discards the margin on opposite side
        https://bugs.webkit.org/show_bug.cgi?id=151802

        Reviewed by Sergio Villar Senin.

        Tests to verify the specified margins account for determining the available space for
        auto-margins alignment.

        * fast/css-grid-layout/grid-item-auto-margins-must-respect-specified-margins-expected.txt: Added.
        * fast/css-grid-layout/grid-item-auto-margins-must-respect-specified-margins.html: Added.

2015-12-03  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaselining svg/custom/bug78807.svg since actual results now match Mac expectations
        https://bugs.webkit.org/show_bug.cgi?id=151804

        Unreviewed test gardening.

        * platform/win/svg/custom/bug78807-expected.txt:

2015-12-03  Ryan Haddad  <ryanhaddad@apple.com>

        Skipping failing sputnik/Unicode/Unicode_510 tests pending further investigation
        https://bugs.webkit.org/show_bug.cgi?id=151505

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2015-12-03  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/css/pseudo-visited-background-color-on-input.html as failing on win
        https://bugs.webkit.org/show_bug.cgi?id=151756

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2015-12-03  Ryan Haddad  <ryanhaddad@apple.com>

        fast/borders/hidpi-border-clipping-right-after-move.html
        https://bugs.webkit.org/show_bug.cgi?id=151754

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2015-12-03  Gyuyoung Kim  <gyuyoung.kim@webkit.org>

        Unreviewed EFL urgent gardening. Skip web-platform-tests
        because it has been timeout since r192796.

        * platform/efl/TestExpectations:

2015-12-02  Mark Lam  <mark.lam@apple.com>

        Polymorphic operand types for DFG and FTL mul.
        https://bugs.webkit.org/show_bug.cgi?id=151746

        Reviewed by Filip Pizlo.

        * js/regress/ftl-object-mul-expected.txt: Added.
        * js/regress/ftl-object-mul.html: Added.
        * js/regress/script-tests/ftl-object-mul.js: Added.
        (o1.valueOf):
        (foo):

2015-12-02  Myles C. Maxfield  <mmaxfield@apple.com>

        Unify font-variant-* with font-variant shorthand
        https://bugs.webkit.org/show_bug.cgi?id=149773

        Reviewed by Darin Adler.

        Update tests. Also temporarily skip existing font-features tests until
        https://bugs.webkit.org/show_bug.cgi?id=149774 is fixed.

        * css3/font-variant-parsing-expected.txt:
        * css3/font-variant-parsing.html:
        * fast/css/font-property-priority-expected.txt:
        * fast/css/font-shorthand-expected.txt:
        * fast/css/parsing-font-variant-ligatures-expected.txt:
        * fast/css/parsing-font-variant-ligatures.html:
        * fast/inspector-support/style-expected.txt:
        * fast/text/font-variant-shorthand-expected.txt: Added.
        * fast/text/font-variant-shorthand.html: Added.
        * platform/mac/TestExpectations:
        * platform/mac/fast/writing-mode/broken-ideograph-small-caps-expected.txt:

2015-12-02  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaselining fast/dom/adopt-attribute-crash-expected for win
        https://bugs.webkit.org/show_bug.cgi?id=151762

        Reviewed by Darin Adler.

        * platform/win/fast/dom/adopt-attribute-crash-expected.txt:

2015-12-02  Alex Christensen  <achristensen@webkit.org>

        Asynchronously call onerror when a content blocker blocks ascript element's load
        https://bugs.webkit.org/show_bug.cgi?id=151649

        Reviewed by Brady Eidson.

        * http/tests/contentextensions/script-onerror-expected.txt: Added.
        * http/tests/contentextensions/script-onerror.html: Added.
        * http/tests/contentextensions/script-onerror.html.json: Added.
        * http/tests/misc/unloadable-script-expected.txt:
        * http/tests/misc/unloadable-script.html:
        * http/tests/security/local-JavaScript-from-remote-expected.txt:
        * http/tests/security/local-JavaScript-from-remote.html:
        Added testRunner.waitUntilDone and testRunner.notifyDone to reflect the fact that onerror is no longer called synchronously.

2015-12-02  Eric Carlson  <eric.carlson@apple.com>

        Fix flaky test added with r192954.

        Unreviewed.

        * fast/mediastream/MediaStreamTrack-getSettings.html:

2015-12-02  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r192955.
        https://bugs.webkit.org/show_bug.cgi?id=151776

        A large number of the tests added with this change are failing
        on Windows (Requested by ryanhaddad on #webkit).

        Reverted changeset:

        "[css border] border-image doesn't honor border-style"
        https://bugs.webkit.org/show_bug.cgi?id=99922
        http://trac.webkit.org/changeset/192955

2015-12-02  Yoav Weiss  <yoav@yoav.ws>

        Fix preloader issue with srcdoc documents.
        https://bugs.webkit.org/show_bug.cgi?id=151744

        Reviewed by Ryosuke Niwa.

        Added a test that makes sure that srcdoc based subresources are properly preloaded.

        * fast/preloader/iframe-srcdoc-expected.txt: Added.
        * fast/preloader/iframe-srcdoc.html: Added.

2015-12-02  Jer Noble  <jer.noble@apple.com>

        Add a setting and restriction which will pause invisible autoplaying video
        https://bugs.webkit.org/show_bug.cgi?id=151412

        Reviewed by Eric Carlson.

        * media/video-restricted-invisible-autoplay-not-allowed-expected.txt: Added.
        * media/video-restricted-invisible-autoplay-not-allowed.html: Added.

2015-12-02  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline fast/parser/xml-declaration-missing-ending-mark.html, fast/parser/xml-colon-entity.html for Win
        https://bugs.webkit.org/show_bug.cgi?id=151763

        Reviewed by Brent Fulgham.

        * platform/win/fast/parser/xml-colon-entity-expected.txt:
        * platform/win/fast/parser/xml-declaration-missing-ending-mark-expected.txt:

2015-12-02  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline fast/dynamic/text-combine.html on win
        https://bugs.webkit.org/show_bug.cgi?id=151761

        Unreviewed test gardening.

        * platform/win/fast/dynamic/text-combine-expected.png:
        * platform/win/fast/dynamic/text-combine-expected.txt:

2015-12-02  Brady Eidson  <beidson@apple.com>

        Modern IDB: Remove all traces of IDBObjectStore::openKeyCursor from tests.
        https://bugs.webkit.org/show_bug.cgi?id=151772

        Reviewed by Alex Christensen.
        
        IDBObjectStore::openKeyCursor no longer exists, so testing it is inherently bogus.

        * platform/mac-wk1/TestExpectations: Two tests now pass with small expectations changes.
        * storage/indexeddb/cursor-basics-expected.txt:
        * storage/indexeddb/cursor-overloads-expected.txt:

        * storage/indexeddb/cursor-overloads.html:
        * storage/indexeddb/optional-arguments.html:
        * storage/indexeddb/resources/cursor-basics.js:
        * storage/indexeddb/resources/deleted-objects.js:
        * storage/indexeddb/resources/exceptions.js:
        * storage/indexeddb/resources/objectstore-basics.js:
        
        * storage/indexeddb/objectstore-keycursor-expected.txt: Removed.
        * storage/indexeddb/objectstore-keycursor.html: Removed.
        * storage/indexeddb/resources/objectstore-keycursor.js: Removed.

2015-12-02  David Hyatt  <hyatt@apple.com>

        Add some more picture element layout tests
        https://bugs.webkit.org/show_bug.cgi?id=151769

        Reviewed by Dean Jackson.

        * fast/picture/image-picture-invalid-expected.txt: Added.
        * fast/picture/image-picture-invalid.html: Added.
        * fast/picture/image-picture-nested-expected.txt: Added.
        * fast/picture/image-picture-nested.html: Added.

2015-12-02  Brady Eidson  <beidson@apple.com>

        Modern IDB: Enable a couple more passing tests.
        https://bugs.webkit.org/show_bug.cgi?id=151766

        Reviewed by Beth Dakin.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/create-object-store-options-expected.txt:

2015-12-02  Ryan Haddad  <ryanhaddad@apple.com>

        Skipping tests on Win that fail due to unimplemented showModalDialog function.
        https://bugs.webkit.org/show_bug.cgi?id=151506

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2015-12-02  Brady Eidson  <beidson@apple.com>

        Modern IDB: IDBTransaction::error is not exposed.
        https://bugs.webkit.org/show_bug.cgi?id=151752

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/modern/basic-add.html:
        * storage/indexeddb/modern/double-abort-expected.txt:
        * storage/indexeddb/modern/index-3.html:
        * storage/indexeddb/resources/transaction-error.js:
        * storage/indexeddb/transaction-error-expected.txt:

2015-12-02  Adenilson Cavalcanti  <cavalcantii@gmail.com>

        [css border] border-image doesn't honor border-style
        https://bugs.webkit.org/show_bug.cgi?id=99922

        Reviewed by Simon Fraser.

        Ensure that WebKit will be compliant to css-backgrounds spec where
        a border with an image will only be rendered if there is a style defined.

        Previous border image tests had to be edited (i.e. define border-style)
        to ensure that a decorated border would be rendered.

        * fast/borders/border-image-01.html:
        * fast/borders/border-image-border-radius.html:
        * fast/borders/border-image-fill-no-intrinsic-size.html:
        * fast/borders/border-image-longhand.html:
        * fast/borders/border-image-massive-scale.html:
        * fast/borders/border-image-omit-right-slice.html:
        * fast/borders/border-image-outset-in-shorthand.html:
        * fast/borders/border-image-outset-split-inline-expected.txt:
        * fast/borders/border-image-outset-split-inline-vertical-lr-expected.txt:
        * fast/borders/border-image-outset-split-inline-vertical-lr.html:
        * fast/borders/border-image-outset-split-inline.html:
        * fast/borders/border-image-outset.html:
        * fast/borders/border-image-repeat.html:
        * fast/borders/border-image-rotate-transform.html:
        * fast/borders/border-image-scale-transform.html:
        * fast/borders/border-image-scaled.html:
        * fast/borders/border-image-scrambled.html:
        * fast/borders/border-image-should-not-display-expected.html: Added.
        * fast/borders/border-image-should-not-display.html: Added.
        * fast/borders/border-image-side-reduction.html:
        * fast/borders/border-image-slice-constrained.html:
        * fast/borders/border-image-slice-missing-right.html:
        * fast/borders/border-image-slices.html:
        * fast/borders/border-image-source.html:
        * fast/borders/border-image-trumps-radius-expected.txt:
        * fast/borders/border-image-trumps-radius.html:
        * fast/borders/hidpi-border-image-gradient-on-subpixels.html:
        * fast/borders/resources/red.png: Added.
        * fast/borders/scaled-border-image.html:
        * fast/gradients/border-image-gradient-expected.txt:
        * fast/gradients/border-image-gradient.html:
        * fast/hidpi/image-set-border-image-comparison.html:
        * fast/hidpi/image-set-border-image-dynamic.html:
        * fast/hidpi/image-set-border-image-simple.html:
        * fast/writing-mode/border-image-horizontal-bt.html:
        * fast/writing-mode/border-image-vertical-lr.html:
        * fast/writing-mode/border-image-vertical-rl.html:
        * platform/mac/fast/borders/border-image-01-expected.txt:
        * platform/mac/fast/borders/border-image-border-radius-expected.txt:
        * platform/mac/fast/borders/border-image-longhand-expected.txt:
        * platform/mac/fast/borders/border-image-massive-scale-expected.txt:
        * platform/mac/fast/borders/border-image-omit-right-slice-expected.txt:
        * platform/mac/fast/borders/border-image-outset-expected.txt:
        * platform/mac/fast/borders/border-image-outset-in-shorthand-expected.txt:
        * platform/mac/fast/borders/border-image-repeat-expected.txt:
        * platform/mac/fast/borders/border-image-rotate-transform-expected.txt:
        * platform/mac/fast/borders/border-image-scale-transform-expected.txt:
        * platform/mac/fast/borders/border-image-scaled-expected.txt:
        * platform/mac/fast/borders/border-image-scrambled-expected.txt:
        * platform/mac/fast/borders/border-image-side-reduction-expected.txt:
        * platform/mac/fast/borders/border-image-slice-constrained-expected.txt:
        * platform/mac/fast/borders/border-image-slices-expected.txt:
        * platform/mac/fast/borders/border-image-source-expected.txt:
        * platform/mac/fast/borders/scaled-border-image-expected.txt:
        * platform/mac/fast/hidpi/image-set-border-image-comparison-expected.txt:
        * platform/mac/fast/hidpi/image-set-border-image-dynamic-expected.txt:
        * platform/mac/fast/hidpi/image-set-border-image-simple-expected.txt:
        * platform/mac/fast/writing-mode/border-image-horizontal-bt-expected.txt:
        * platform/mac/fast/writing-mode/border-image-vertical-lr-expected.txt:
        * platform/mac/fast/writing-mode/border-image-vertical-rl-expected.txt:

2015-12-02  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] Implement MediaStreamTrack.getSettings()
        https://bugs.webkit.org/show_bug.cgi?id=151727

        Reviewed by Jer Noble.

        * fast/mediastream/MediaStream-video-element-expected.txt:
        * fast/mediastream/MediaStream-video-element-track-stop-expected.txt:
        * fast/mediastream/MediaStream-video-element-track-stop.html:
        * fast/mediastream/MediaStream-video-element.html:
        * fast/mediastream/MediaStreamTrack-getSettings-expected.txt: Added.
        * fast/mediastream/MediaStreamTrack-getSettings.html: Added.

2015-12-01  David Hyatt  <hyatt@apple.com>

        Implement the picture element.
        https://bugs.webkit.org/show_bug.cgi?id=116963

        Reviewed by Dean Jackson.

        * fast/picture: Added.
        * fast/picture/image-picture-1x-expected.txt: Added.
        * fast/picture/image-picture-1x.html: Added.
        * fast/picture/resources: Added.
        * fast/picture/resources/blue_rect.jpg: Added.
        * fast/picture/resources/currentSrcHelper.js: Added.
        (fileName):
        (currentSrcFileName):
        (currentSrcFileNameNoParams):
        * fast/picture/resources/image-set-4x.png: Added.

2015-12-02  Jiewen Tan  <jiewen_tan@apple.com>

        Null dereference loading Blink layout test fast/loader/unload-mutation-crash.html
        https://bugs.webkit.org/show_bug.cgi?id=149305
        <rdar://problem/22747892>

        Reviewed by Brent Fulgham.

        This test case is from Blink r180918:
        https://codereview.chromium.org/495743003

        * fast/loader/unload-mutation-crash-expected.txt: Added.
        * fast/loader/unload-mutation-crash.html: Added.

2015-12-02  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Handle YieldExpressions in the ScriptSyntaxTree
        https://bugs.webkit.org/show_bug.cgi?id=151730

        Reviewed by Brian Burg.

        * inspector/model/parse-script-syntax-tree-expected.txt:
        * inspector/model/parse-script-syntax-tree.html:

2015-12-01  Myles C. Maxfield  <mmaxfield@apple.com>

        [Win] Test gardening after r192895

        Unreviewed.

        * fast/text/emoji-overlap-expected.html:
        * fast/text/emoji-overlap.html:

2015-12-01  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r192894 and r192904.
        https://bugs.webkit.org/show_bug.cgi?id=151738

        Crashes sometimes on Windows (Requested by litherum on
        #webkit).

        Reverted changesets:

        "[Win] Web fonts with small caps have excess whitespace with
        the complex text codepath"
        https://bugs.webkit.org/show_bug.cgi?id=151698
        http://trac.webkit.org/changeset/192894

        "Test gardening after r192894"
        http://trac.webkit.org/changeset/192904

2015-12-01  Myles C. Maxfield  <mmaxfield@apple.com>

        [SVG -> OTF Converter] Force UnitsPerEm to 1000
        https://bugs.webkit.org/show_bug.cgi?id=151650

        Reviewed by Antti Koivisto.

        Some tests have quantization differences.

        * fast/ruby/ruby-expansion-cjk-2-expected.html:
        * fast/ruby/ruby-expansion-cjk-3-expected.html:
        * fast/ruby/ruby-expansion-cjk-4-expected.html:
        * fast/ruby/ruby-expansion-cjk-5-expected.html:
        * fast/ruby/ruby-expansion-cjk-expected.html:
        * platform/mac-wk2/svg/W3C-SVG-1.1/fonts-elem-04-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/fonts-elem-01-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/fonts-elem-02-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/fonts-elem-03-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/fonts-elem-07-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/text-intro-01-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/text-intro-02-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/text-intro-03-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/text-intro-04-t-expected.txt:
        * platform/mac/svg/batik/text/textEffect3-expected.txt:
        * platform/mac/svg/batik/text/textPosition2-expected.txt:
        * platform/mac/svg/wicd/test-rightsizing-b-expected.txt:
        * svg/custom/acid3-test-77-expected.txt:

2015-12-01  Brady Eidson  <beidson@apple.com>

        Add updated test result missing from http://trac.webkit.org/changeset/192924
        https://bugs.webkit.org/show_bug.cgi?id=151725

        * storage/indexeddb/modern/opendatabase-request-event-expected.txt:

2015-12-01  Ryan Haddad  <ryanhaddad@apple.com>

        Marking http/tests/xmlhttprequest/methods-async.html as flaky on Yosemite WK2
        https://bugs.webkit.org/show_bug.cgi?id=151729

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2015-12-01  Brady Eidson  <beidson@apple.com>

        Give a more detailed message for TypeErrors that result from EnforceRange.
        https://bugs.webkit.org/show_bug.cgi?id=151725

        Reviewed by Tim Horton.

        * crypto/subtle/aes-cbc-generate-key-expected.txt:
        * js/dom/webidl-type-mapping-expected.txt:
        * storage/indexeddb/intversion-bad-parameters-expected.txt:
        * storage/indexeddb/version-change-event-basic-expected.txt:

2015-12-01  Myles C. Maxfield  <mmaxfield@apple.com>

        Test gardening after r192894

        Unreviewed.

        * fast/text/small-caps-complex-expected.html:
        * fast/text/small-caps-complex.html:

2015-12-01  Myles C. Maxfield  <mmaxfield@apple.com>

        [iOS] Adjacent emoji overlap each other
        https://bugs.webkit.org/show_bug.cgi?id=151690
        <rdar://problem/23430453>

        Reviewed by Simon Fraser.

        * fast/text/emoji-overlap-expected.html: Added.
        * fast/text/emoji-overlap.html: Added.

2015-12-01  Myles C. Maxfield  <mmaxfield@apple.com>

        [Win] Web fonts with small caps have excess whitespace with the complex text codepath
        https://bugs.webkit.org/show_bug.cgi?id=151698

        Reviewed by Darin Adler.

        * fast/text/resources/tinyfont.svg: Added.
        * fast/text/small-caps-complex-expected.html: Added.
        * fast/text/small-caps-complex.html: Added.

2015-12-01  Ryan Haddad  <ryanhaddad@apple.com>

        Marking http/tests/xmlhttprequest/workers/methods.html as flaky on Yosemite WK2
        https://bugs.webkit.org/show_bug.cgi?id=151709

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2015-12-01  Brady Eidson  <beidson@apple.com>

        Skip some specific IDB tests in preparation for enabling the entire directory.

        Reviewed in person by Sam Weinig.

        * platform/mac-wk1/TestExpectations:

2015-12-01  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/create-and-remove-object-store.html fails.
        https://bugs.webkit.org/show_bug.cgi?id=151704

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/modern/idbdatabase-deleteobjectstore-failures-expected.txt:

2015-12-01  Brady Eidson  <beidson@apple.com>

        Modern IDB: storage/indexeddb/basics.html fails.
        https://bugs.webkit.org/show_bug.cgi?id=151694

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/modern/deletedatabase-1.html:
        * storage/indexeddb/modern/opendatabase-versions.html:
        * storage/indexeddb/modern/versionchange-event.html:

2015-12-01  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed, rolling out r192876.

        It broke a lot of JSC and layout tests for GTK and EFL

        Reverted changeset:

        "[ES6] "super" and "this" should be lexically bound inside an
        arrow function and should live in a JSLexicalEnvironment"
        https://bugs.webkit.org/show_bug.cgi?id=149338
        http://trac.webkit.org/changeset/192876

2015-12-01  Youenn Fablet  <youenn.fablet@crf.canon.fr>

        [Streams API] pull function of tee should call readFromReadableStreamReader directly
        https://bugs.webkit.org/show_bug.cgi?id=151497

        Unreviewed.

        Adding non regression test.

        * streams/streams-promises-expected.txt:
        * streams/streams-promises.html:

2015-12-01  Youenn Fablet  <youenn.fablet@crf.canon.fr>

        [Streams API] teeReadableStream should not directly use stream.getReader()
        https://bugs.webkit.org/show_bug.cgi?id=151487

        Reviewed by Darin Adler.

        Adding non-regression test.

        * streams/streams-promises-expected.txt:
        * streams/streams-promises.html:

2015-12-01  Skachkov Oleksandr  <gskachkov@gmail.com>

        [ES6] "super" and "this" should be lexically bound inside an arrow function and should live in a JSLexicalEnvironment
        https://bugs.webkit.org/show_bug.cgi?id=149338

        Reviewed by Saam Barati.

        * js/arrowfunction-supercall-expected.txt: Added.
        * js/arrowfunction-supercall.html: Added.
        * js/arrowfunction-tdz-expected.txt: Added new expectation.
        * js/script-tests/arrowfunction-supercall.js: Added.
        * js/script-tests/arrowfunction-tdz.js: Added new cases.

2015-12-01  Youenn Fablet  <youenn.fablet@crf.canon.fr>

        [Streams API] streams should not directly use Number and related methods
        https://bugs.webkit.org/show_bug.cgi?id=151499

        Reviewed by Darin Adler.

        Added a non-regression test.

        * streams/streams-promises-expected.txt:
        * streams/streams-promises.html:

2015-12-01  Youenn Fablet  <youenn.fablet@crf.canon.fr>

        [Streams API] Remove use of @catch for exposed promises
        https://bugs.webkit.org/show_bug.cgi?id=151625

        Reviewed by Darin Adler.

        * streams/streams-promises.html: beefing up the catch test by also overwritting Promise.prototype.then.

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: Unskip "storage/indexeddb/mozilla" instead of each individual test inside of it.
        https://bugs.webkit.org/show_bug.cgi?id=151693

        Reviewed by Geoffrey Garen.

        * platform/mac-wk1/TestExpectations:

2015-11-30  Jiewen Tan  <jiewen_tan@apple.com>

        Amazon.com Additional Information links aren't clickable
        https://bugs.webkit.org/show_bug.cgi?id=151401
        <rdar://problem/23454261>

        Reviewed by Darin Adler.

        * fast/block/float/hit-test-on-overlapping-floats-expected.txt: Added.
        * fast/block/float/hit-test-on-overlapping-floats.html: Added.

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: Iterating index cursors to a specific key is busted.
        https://bugs.webkit.org/show_bug.cgi?id=151684

        Reviewed by Darin Adler.

        * platform/mac-wk1/TestExpectations:

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: ObjectStore cursors should not be able to iterate out of their range.
        https://bugs.webkit.org/show_bug.cgi?id=151683

        Reviewed by Darin Adler.

        * platform/mac-wk1/TestExpectations:

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: "prevunique" cursors should point at the lowest primary key that matches, not the highest.
        https://bugs.webkit.org/show_bug.cgi?id=151675.

        Reviewed by Darin Adler.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/modern/index-cursor-1-expected.txt:
        * storage/indexeddb/modern/index-cursor-2-expected.txt:
        * storage/indexeddb/modern/index-cursor-3-expected.txt:

2015-11-30  Jiewen Tan  <jiewen_tan@apple.com>

        Null dereference loading Blink layout test http/tests/misc/detach-during-notifyDone.html
        https://bugs.webkit.org/show_bug.cgi?id=149309
        <rdar://problem/22748363>

        Reviewed by Brent Fulgham.

        The test case is from Blink r175601:
        https://codereview.chromium.org/317513002
        The test case will generate a set of weird ordering events that affects the documentLoader:
        1. The subframe finishes loading, and since the frame’s testRunner is not set to wait until
        done, WebKitTestRunner stops the load (by calling WKBundlePageStopLoading()).
        2. This causes the in-progress XHR to be aborted, which causes its readyState to become DONE
        (this bug doesn’t always reproduce because sometimes the XHR has already finished before the
        frame finishes loading).
        3. The onreadystatechange callback is executed, which sets innerHTML on the parent frame.
        4. Setting innerHTML disconnects the subframe, nulling out its DocumentLoader.
        5. We return to WebFrameLoaderClient::dispatchDidFinishLoad() from step #1, but now the
        FrameLoader’s DocumentLoader is null. And WebKit crashes here.

        Note that steps 2-4 happen synchronously inside WebFrameLoaderClient::dispatchDidFinishLoad().

        * http/tests/misc/detach-during-notifyDone-expected.txt: Added.
        * http/tests/misc/detach-during-notifyDone.html: Added.
        * http/tests/misc/resources/detached-frame.html: Added.

2015-11-30  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r192819.
        https://bugs.webkit.org/show_bug.cgi?id=151681

        This change broke existing layout tests on Windows (Requested
        by ryanhaddad on #webkit).

        Reverted changeset:

        "Unify font-variant-* with font-variant shorthand"
        https://bugs.webkit.org/show_bug.cgi?id=149773
        http://trac.webkit.org/changeset/192819

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: Set the correct source on the IDBRequest for cursor updates
        https://bugs.webkit.org/show_bug.cgi?id=151665

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:

2015-11-30  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/forms/state-restore-per-form.html as a flaky timeout on mac-wk2
        https://bugs.webkit.org/show_bug.cgi?id=150542

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: Correct handling of cursors finishing iteration.
        https://bugs.webkit.org/show_bug.cgi?id=151664

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:

2015-11-30  Myles C. Maxfield  <mmaxfield@apple.com>

        Unify font-variant-* with font-variant shorthand
        https://bugs.webkit.org/show_bug.cgi?id=149773

        Reviewed by Darin Adler.

        Update tests. Also temporarily skip existing font-features tests until
        https://bugs.webkit.org/show_bug.cgi?id=149774 is fixed.

        * css3/font-variant-parsing-expected.txt:
        * css3/font-variant-parsing.html:
        * fast/css/font-property-priority-expected.txt:
        * fast/css/font-shorthand-expected.txt:
        * fast/css/parsing-font-variant-ligatures-expected.txt:
        * fast/css/parsing-font-variant-ligatures.html:
        * fast/inspector-support/style-expected.txt:
        * fast/text/font-variant-shorthand-expected.txt: Added.
        * fast/text/font-variant-shorthand.html: Added.
        * platform/mac/TestExpectations:
        * platform/mac/fast/writing-mode/broken-ideograph-small-caps-expected.txt:

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: After versionchange transactions abort, fire onerror on the original IDBOpenDBRequest.
        https://bugs.webkit.org/show_bug.cgi?id=151648

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/modern/abort-requests-cancelled-expected.txt:
        * storage/indexeddb/modern/abort-requests-cancelled.html:
        * storage/indexeddb/modern/aborted-put-expected.txt:
        * storage/indexeddb/modern/aborted-put.html:
        * storage/indexeddb/modern/createobjectstore-basic-expected.txt:
        * storage/indexeddb/modern/createobjectstore-basic.html:
        * storage/indexeddb/modern/deleteindex-2-expected.txt:
        * storage/indexeddb/modern/deleteindex-2.html:
        * storage/indexeddb/modern/deleteobjectstore-1-expected.txt:
        * storage/indexeddb/modern/deleteobjectstore-1.html:
        * storage/indexeddb/modern/idbdatabase-transaction-failures-expected.txt:
        * storage/indexeddb/modern/versionchange-abort-then-reopen-expected.txt:
        * storage/indexeddb/modern/versionchange-abort-then-reopen.html:

2015-11-30  Chris Dumez  <cdumez@apple.com>

        location.origin is undefined in a web worker
        https://bugs.webkit.org/show_bug.cgi?id=151614

        Reviewed by Darin Adler.

        Update existing layout test to confirm the existence of location.origin when in a
        WorkerGlobalScope.

        * fast/workers/resources/worker-location.js:
        * fast/workers/worker-location-expected.txt:

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: Support updating cursor values when the object store uses inline keys.
        https://bugs.webkit.org/show_bug.cgi?id=151647

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: openCursor() fix resulting in at least 4 more passing tests.
        https://bugs.webkit.org/show_bug.cgi?id=151630

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:
        * storage/indexeddb/modern/cursor-2-expected.txt:
        * storage/indexeddb/modern/cursor-2.html:
        * storage/indexeddb/modern/cursor-3-expected.txt:
        * storage/indexeddb/modern/cursor-3.html:
        * storage/indexeddb/modern/cursor-4-expected.txt:
        * storage/indexeddb/modern/cursor-4.html:
        * storage/indexeddb/modern/deleteindex-1-expected.txt:
        * storage/indexeddb/modern/deleteindex-1.html:
        * storage/indexeddb/modern/deleteindex-2-expected.txt:
        * storage/indexeddb/modern/deleteindex-2.html:
        * storage/indexeddb/modern/index-4-expected.txt:
        * storage/indexeddb/modern/index-4.html:
        * storage/indexeddb/modern/index-cursor-1-expected.txt:
        * storage/indexeddb/modern/index-cursor-1.html:
        * storage/indexeddb/modern/index-cursor-2-expected.txt:
        * storage/indexeddb/modern/index-cursor-2.html:
        * storage/indexeddb/modern/index-cursor-3-expected.txt:
        * storage/indexeddb/modern/index-cursor-3.html:

2015-11-30  Ryan Haddad  <ryanhaddad@apple.com>

        Marking http/tests/cache/disk-cache/disk-cache-request-max-stale.html as flaky on Yosemite WK2
        https://bugs.webkit.org/show_bug.cgi?id=143159

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2015-11-30  Brady Eidson  <beidson@apple.com>

        Modern IDB: Support keyPath injection into object store records.
        https://bugs.webkit.org/show_bug.cgi?id=151640

        Reviewed by Andy Estes.

        * platform/mac-wk1/TestExpectations:

2015-11-29  Antoine Quint  <graouts@apple.com>

        Browser does not fall back to SVG attribute value when CSS style value is invalid or not supported
        https://bugs.webkit.org/show_bug.cgi?id=147932

        Reviewed by Dean Jackson.

        Testing that we correctly fall back to the presentation attribute for SVGPaint and SVGColor values
        specified with an invalid keyword in a `style` attribute. We also update the expected output for
        svg/css/svg-attribute-parser-mode.html which is now in line with values returned by Firefox and
        Chrome, where we correctly use the default value instead of null objects, which was definitely
        an error.

        * svg/css/invalid-color-cascade-expected.svg: Added.
        * svg/css/invalid-color-cascade.svg: Added.
        * svg/css/invalid-paint-cascade-expected.svg: Added.
        * svg/css/invalid-paint-cascade.svg: Added.
        * svg/css/script-tests/svg-attribute-parser-mode.js:
        * svg/css/svg-attribute-parser-mode-expected.txt:

2015-11-18  Andy Estes  <aestes@apple.com>

        [Content Filtering] Crash in DocumentLoader::notifyFinished() when allowing a media document to load
        https://bugs.webkit.org/show_bug.cgi?id=151433
        rdar://problem/23506594

        Reviewed by Alexey Proskuryakov.

        * contentfiltering/allow-media-document-expected.txt: Added.
        * contentfiltering/allow-media-document.html: Added.
        * contentfiltering/resources/test.mp4: Added.

2015-11-25  Pranjal Jumde  <pjumde@apple.com>

        Checks for buffer-overflows when reading characters from textRun
        https://bugs.webkit.org/show_bug.cgi?id=151055
        <rdar://problem/23251789>

        Reviewed by Myles C. Maxfield.

        * dom/html/level1/core/151055_asan.html:
        * dom/html/level1/core/151055_asan-expected.txt:

2015-11-24  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r192536, r192722, and r192743.
        https://bugs.webkit.org/show_bug.cgi?id=151593

        Still causing trouble. (Requested by kling on #webkit).

        Reverted changesets:

        "[JSC] JSPropertyNameEnumerator could be destructorless."
        https://bugs.webkit.org/show_bug.cgi?id=151242
        http://trac.webkit.org/changeset/192536

        "REGRESSION(r192536): Null pointer dereference in
        JSPropertyNameEnumerator::visitChildren()."
        https://bugs.webkit.org/show_bug.cgi?id=151495
        http://trac.webkit.org/changeset/192722

        "REGRESSION(r192536): Null pointer dereference in
        JSPropertyNameEnumerator::visitChildren()."
        https://bugs.webkit.org/show_bug.cgi?id=151495
        http://trac.webkit.org/changeset/192743

2015-11-24  Xabier Rodriguez Calvar  <calvaris@igalia.com>

        [Streams API] Implement pipeTo method in readable Stream
        https://bugs.webkit.org/show_bug.cgi?id=151588

        Reviewed by Darin Adler.

        Test "Piping to a writable stream that does not consume the writes fast enough exerts backpressure on the
        source" was moved to its own file because it causes timing issues.

        * streams/reference-implementation/pipe-to.html: Moved "Piping to a writable stream that does not consume the
        writes fast enough exerts backpressure on the source" test to its own file.
        * streams/pipe-to.html: Added with "Piping to a writable stream that does not consume the writes fast enough
        exerts backpressure on the source" test.
        * streams/reference-implementation/brand-checks.html: Fixed issue with the creation of a ReadableStreamReader.
        * streams/pipe-to-expected.txt:
        * streams/reference-implementation/brand-checks-expected.txt:
        * streams/reference-implementation/pipe-through-expected.txt:
        * streams/reference-implementation/pipe-to-expected.txt:
        * streams/reference-implementation/pipe-to-options-expected.txt:
        * streams/reference-implementation/readable-stream-templated-expected.txt: Expectations.
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations: Flagged pipe-to test because of webkit.org/b/147933.

2015-11-24  Antti Koivisto  <antti@apple.com>

        REGRESSION (r190983): Non-element, non-text nodes should not be distributed to slots
        https://bugs.webkit.org/show_bug.cgi?id=151566
        rdar://problem/23430177

        Reviewed by Zalan Bujtas.

        * fast/html/details-comment-crash-expected.html: Added.
        * fast/html/details-comment-crash.html: Added.

2015-11-23  Brady Eidson  <beidson@apple.com>

        Modern IDB: Unskip all indexeddb/mozilla tests that pass.
        https://bugs.webkit.org/show_bug.cgi?id=151568

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:

2015-11-23  Brady Eidson  <beidson@apple.com>

        Modern IDB: When a transaction is aborted, call onerror handlers for all in-progress requests.
        https://bugs.webkit.org/show_bug.cgi?id=151550

        Reviewed by Alex Christensen.

        * storage/indexeddb/modern/abort-requests-cancelled-expected.txt: Added.
        * storage/indexeddb/modern/abort-requests-cancelled.html: Added.
        * storage/indexeddb/modern/idbtransaction-objectstore-failures-expected.txt:
        * storage/indexeddb/modern/idbtransaction-objectstore-failures.html:
        * storage/indexeddb/modern/index-5-expected.txt:
        * storage/indexeddb/modern/index-5.html:

2015-11-23  Brady Eidson  <beidson@apple.com>

        Modern IDB: Unskip storage/indexeddb/mozilla/global-data.html.
        https://bugs.webkit.org/show_bug.cgi?id=151557

        Reviewed by Alex Christensen.

        * platform/mac-wk1/TestExpectations:

2015-11-17  Sergio Villar Senin  <svillar@igalia.com>

        ASSERTION FAILED: freeSpace >= 0 in WebCore::RenderGrid::computeTrackSizesForDirection
        https://bugs.webkit.org/show_bug.cgi?id=151254

        Reviewed by Darin Adler.

        * fast/css-grid-layout/grid-quirks-mode-huge-margin-crash-expected.txt: Added.
        * fast/css-grid-layout/grid-quirks-mode-huge-margin-crash.html: Added.

2015-11-22  Myles C. Maxfield  <mmaxfield@apple.com>

        Add a test to make sure that font-variant: inherit works correctly.

        Unreviewed.

        * fast/text/font-variant-inherit-expected.html: Added.
        * fast/text/font-variant-inherit.html: Added.

2015-11-22  Myles C. Maxfield  <mmaxfield@apple.com>

        Font selection should not consult font-variant property
        https://bugs.webkit.org/show_bug.cgi?id=151537

        Reviewed by Simon Fraser.

        * fast/text/font-selection-font-variant-expected.html: Added.
        * fast/text/font-selection-font-variant.html: Added.

== Rolled over to ChangeLog-2015-11-21 ==
