<script>
if (window.testRunner)
     testRunner.dumpEditingCallbacks();
</script>
<p>There was a bug in paste's smart replace whitespace handling.  In some cases, it used information gathered at the start of the selection being pasted into to decide whether or not a space needed to be added to the end of the incoming content.</p>
<p>A smart paste is performed into a selection starting in one block and ending in another.  Spaces should surround the pasted word.</p>
<div id="test" contenteditable="true"><div>foo</div><div>x bar</div></div>

<script src="../editing.js"></script>
<script src="../../resources/ui-helper.js"></script>
<script>
var e = document.getElementById("test");

async function runTest() {
    getSelection().setBaseAndExtent(e, 0, e, 0);
    await UIHelper.selectWordByDoubleTapOrClick(document.getElementById('test'));
    copyCommand();
    moveSelectionBackwardByCharacterCommand();
    moveSelectionForwardByCharacterCommand();
    extendSelectionForwardByLineCommand();
    pasteCommand();
}

UIHelper.wait(runTest());
</script>
