<!DOCTYPE html>
<head>
<script type="text/javascript" src="resources/reveal-utilities.js"></script>
</head>
<body>
<div>This test places the caret, inspects its position, scrolls, and immediately inspects the caret's position again.
The two positions should be different. If this test passes, "Result: Pass" will be printed below the list of numbers.</div>
<div>Scrolling with the mouse does not cause the caret's screen position to be recomputed</div>
<span style="position:absolute; visibility:hidden" id="single-digit">0</span>
<div style="border:thin solid black; overflow:scroll" contenteditable="true" id="input-contenteditable"></div>
Result: <span id="console"></div>
<script>
if (window.testRunner)
    testRunner.dumpAsText();
var contentEditable = document.getElementById("input-contenteditable");
contentEditable.innerHTML = generateNumbers(0, 30, 2, "<br>");
var singleDigitHeight = document.getElementById("single-digit").clientHeight;
var contentEditableSize = 10;
contentEditable.style.height = (singleDigitHeight * contentEditableSize) + "px";
contentEditable.focus();
var child = contentEditable.firstChild;
for (var i = 0; i < 36; ++i)
    child = child.nextSibling;
getSelection().collapse(child, 0);
var before;
if (window.internals)
    before = internals.absoluteCaretBounds(document).top;
if (window.eventSender) {
    var input = document.getElementById('input-contenteditable');
    var x = contentEditable.offsetLeft + contentEditable.offsetWidth / 2;
    var y = contentEditable.offsetTop + contentEditable.offsetHeight / 2;
    eventSender.mouseMoveTo(x, y);
    eventSender.mouseScrollBy(0, -50);
}
var after;
if (window.internals)
    after = internals.absoluteCaretBounds(document).top;
var result = "FAIL";
if (before != after)
    result = "PASS";
document.getElementById("console").textContent = result;
</script>
</body>
