<!DOCTYPE html>
<html>
<script>
function runTest() {
    if (window.testRunner) {
        testRunner.dumpAsText();
        testRunner.waitUntilDone();
    }

    var image = new Image();
    var first = true;
    image.onload = function () {
        if (!first) {
            document.getElementById('result').innerHTML = 'SUCCESS';
            if (window.testRunner)
                testRunner.notifyDone();
        }
        image.src = 'resources/image-set-4x.png';
        first = false;
    }

    image.src = 'resources/blue_rect.jpg'
}
</script>
<body onload="runTest()">
    <div>This tests that an image element is loading even if its src was changed after the page's onload event.</div>
<div id="result">FAILURE</div>
</body>
</html>
