<!DOCTYPE html>
<html><head>
<style>
.patient {
    overflow: hidden;
    height: 40px;
    background-color: blue;
}
.patient > div {
   display: none;
   position: relative;
}
</style>
</head>
<body>
<!-- There should not be a red rect. -->
<div class="patient" id="overflow">
    <div></div>
    <div id="display" style="height: 200px; background-color: red;"></div>
</div>
<script src="resources/text-based-repaint.js"></script>
<script>
    window.onload = function() {
        var overflow = document.getElementById("overflow");
        var display = document.getElementById("display");

        repaintTest = function() {
            overflow.style.overflow = "visible";
            display.style.display = "block";
        }
        runRepaintTest();

        function rewrite() {
            repaintTest = function() {
                overflow.style.overflow = "hidden";
                display.style.display = "none";
            }
            runRepaintTest();
        }
        if (window.testRunner && window.internals)
            rewrite();
        else
            setTimeout(rewrite, 100);
    };
</script>
</body></html>
