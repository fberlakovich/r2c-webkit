<!DOCTYPE html><!-- webkit-test-runner [ useFlexibleViewport=true ] -->
<html>
<head>
<meta id="viewport" name="viewport" content="width=400, initial-scale=1">
<script>
if (window.testRunner)
    testRunner.waitUntilDone();
if (window.internals) {
    internals.settings.setTextAutosizingEnabled(true);
    internals.settings.setTextAutosizingUsesIdempotentMode(true);
}
</script>
</head>
<body style="font: 14px 'Arial'; width: 631px;">
<div><em id="em">Japan</em> with Everything about modern and traditional emphasis</div>
<div style="height: 4000px; background: green;"></div>
<script>
function _waitForCondition(condition, completionHandler)
{
  if (condition())
    completionHandler();
  else
    setTimeout(_waitForCondition, 5, condition, completionHandler);
}

const em = document.getElementById("em");
em.getBoundingClientRect();
window.setTimeout(function() {
    document.getElementById("viewport").content = "width=400, initial-scale=0.70";
    em.getBoundingClientRect();
}, 0);
_waitForCondition(function() {
    return window.getComputedStyle(document.getElementById("em")).getPropertyValue("font-size") != "14px";
}, function() {
    if (window.testRunner)
        testRunner.notifyDone();
});
</script>
</body>
</html>
